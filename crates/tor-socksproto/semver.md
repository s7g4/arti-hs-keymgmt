MODIFIED: Added SocksClientHandshake for client-side support.

