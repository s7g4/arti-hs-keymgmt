BREAKING: write functions now return a Result.
